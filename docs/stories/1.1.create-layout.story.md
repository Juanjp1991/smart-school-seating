# Story 1.1: Create Classroom Layout

## Status
Ready for Review

## Story
**As a** teacher,
**I want** to create a classroom layout by specifying the number of rows and columns,
**so that** I can quickly define the basic structure of my room.

## Acceptance Criteria
1. User can input a number for rows and columns.
2. The UI displays a grid matching the specified dimensions.

## Tasks / Subtasks
- [x] Task 1: Set up layout editor page structure (AC: 1, 2)
  - [x] Create /app/layout-editor page component
  - [x] Add basic page routing in Next.js
  - [x] Implement grid dimension inputs (rows, cols)
- [x] Task 2: Create grid display component (AC: 2)
  - [x] Create Grid.js component in /components/layout
  - [x] Implement grid rendering based on dimensions
  - [x] Add basic grid cell styling
- [x] Task 3: Integrate grid state management (AC: 1, 2)
  - [x] Implement state for grid dimensions
  - [x] Connect input changes to grid display updates
  - [x] Validate input ranges (reasonable classroom sizes)
- [x] Task 4: Unit testing
  - [x] Test grid dimension input validation
  - [x] Test grid rendering with various dimensions
  - [x] Test state updates and re-rendering

## Dev Notes

### Previous Story Insights
No previous story - this is the first story in the epic.

### Data Models
**Layout Data Structure** [Source: architecture/4-data-models-in-indexeddb.md]:
- `layouts` store schema: `id`, `name`, `grid_rows`, `grid_cols`, `furniture` (JSON)
- This story focuses on the `grid_rows` and `grid_cols` fields
- `furniture` field will be populated in subsequent stories

### API Specifications
**IndexedDB Integration** [Source: architecture/1-high-level-architecture.md, architecture/4-data-models-in-indexeddb.md]:
- Local-first architecture using IndexedDB for data persistence
- No backend API calls required for this story
- Database service located at `/lib/db.js`

### Component Specifications
**Layout Editor Components** [Source: architecture/2-uxui-flow-design-principles.md#21-screen-layout-editor]:
- Layout Editor mockup shows toolbar with [Rows: 8] [Cols: 6] inputs
- Main grid canvas for teacher interaction
- Components needed: Grid.js, LayoutToolbar.js (basic inputs portion)

**UI Design Requirements** [Source: architecture/2-uxui-flow-design-principles.md]:
- Core Principle: Simplicity and Focus - clean, intuitive, minimize clicks
- Toolbar on top design pattern
- Grid should be the main visual element on the page

### File Locations
**File Structure** [Source: architecture/3-proposed-frontend-file-structure-reactnextjs.md]:
- Page: `/src/app/layout-editor/page.js`
- Grid component: `/src/components/layout/Grid.js`
- Toolbar component: `/src/components/layout/LayoutToolbar.js`
- Common components: `/src/components/common/Input.js`

### Testing Requirements
**Testing Strategy** [Source: architecture/testing-strategy.md]:
No specific guidance found in architecture docs - follow Next.js/React testing best practices

### Technical Constraints
**Technology Stack** [Source: architecture/1-high-level-architecture.md]:
- React with Next.js framework
- Local-first architecture
- IndexedDB for data persistence
- Express server for static file serving only

### Testing
**Testing Standards:**
- No specific testing framework specified in architecture docs
- Follow React/Next.js standard testing practices
- Test file location: Follow Next.js conventions (__tests__ or .test.js files)
- Test grid rendering, input validation, and state management
- Ensure responsive design works across different screen sizes

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-05 | 1.0 | Initial story creation | Bob (SM) |
| 2025-09-05 | 1.1 | Story implementation completed | James (Dev) |
| 2025-09-05 | 1.2 | Grid responsive improvements and E2E testing added | James (Dev) |
| 2025-09-05 | 1.3 | Fixed grid layout issues and optimized space utilization | James (Dev) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
Claude Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References
- Grid layout analysis using Playwright screenshots and dimension measurement
- Fixed cell overflow issue where last row extended beyond container bounds
- Performance optimization: changed from CSS fractional units (1fr) to calculated pixel values
- Space utilization improvement: increased from ~300-350px to 550-620px grid width (75% improvement)
- Window resize handling implemented with useEffect hook and dimension state management

### Completion Notes List
- Successfully initialized Next.js project with TypeScript and Playwright E2E testing
- Created fully responsive grid component with dynamic cell sizing
- Implemented input validation to prevent invalid grid sizes (1-20 range)
- Fixed grid layout issues: uniform cell sizes, proper container fitting, optimal space utilization
- Grid now uses 85% of viewport width and 90% of available height for maximum usability
- Added comprehensive test suite: 12 unit tests + 7 E2E tests, all passing
- Layout editor page fully functional with real-time grid updates and window resize handling
- All acceptance criteria exceeded: users can input dimensions and see large, responsive grid that uses available space effectively

### File List
**Created Files:**
- `package.json` - Next.js project configuration with dependencies including Playwright
- `next.config.js` - Next.js configuration  
- `tsconfig.json` - TypeScript configuration
- `jest.config.js` - Jest testing configuration with Playwright exclusion
- `jest.setup.js` - Jest setup file
- `playwright.config.ts` - Playwright E2E testing configuration
- `.eslintrc.json` - ESLint configuration for code quality
- `app/layout.tsx` - Root layout component
- `app/globals.css` - Global styles including responsive grid and toolbar
- `app/page.tsx` - Home page with navigation
- `app/layout-editor/page.tsx` - Main layout editor page with optimized container layout
- `components/layout/Grid.tsx` - Responsive grid component with dynamic sizing and window resize handling
- `__tests__/components/layout/Grid.test.tsx` - Grid component unit tests (6 tests)
- `__tests__/app/layout-editor/page.test.tsx` - Layout editor unit tests (6 tests)
- `e2e/layout-editor.spec.ts` - End-to-end tests for grid functionality (7 tests)

**Created Directories:**
- `app/` - Next.js app router pages
- `components/layout/` - Layout-specific components
- `components/common/`, `components/roster/`, `components/plan/`, `components/ui/` - Component organization
- `lib/`, `hooks/`, `styles/` - Supporting directories for future use
- `e2e/` - Playwright end-to-end tests
- `__tests__/` - Jest unit test structure

## QA Results
*Results from QA Agent review will be populated here after implementation*