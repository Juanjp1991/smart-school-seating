# Story 1.3: Place Seats

## Status
Completed (Implemented as part of Story 1.2)

## Story
**As a** teacher,
**I want** to place student seats by clicking on grid spaces,
**so that** I can easily 'paint' the seating area.

## Acceptance Criteria
1. User can select a "Student Seat" tool.
2. Clicking an empty grid cell turns it into a "seat".
3. Clicking a "seat" cell turns it back into an empty cell.

## Tasks / Subtasks
- [x] Task 1: Implement seat tool selection (AC: 1)
  - [x] Add "Student Seat" tool button to toolbar
  - [x] Add seat tool to ToolType interface
  - [x] Implement seat tool selection state management
- [x] Task 2: Implement seat placement logic (AC: 2, 3)
  - [x] Add seat placement logic to grid click handler
  - [x] Implement seat state management using Set<string>
  - [x] Add seat toggle functionality (click to add/remove)
  - [x] Handle seat-furniture collision (prevent seat on furniture)
- [x] Task 3: Implement seat visual design
  - [x] Add seat rendering with ðŸ’º emoji
  - [x] Style seat cells with green background and hover effects
  - [x] Ensure visual distinction from furniture and empty cells
- [x] Task 4: Testing and validation
  - [x] Add unit tests for seat functionality
  - [x] Add E2E tests for seat placement scenarios
  - [x] Test seat-furniture interaction edge cases

## Dev Notes

### Implementation Context
This story was implemented as part of Story 1.2 (Add Furniture) when the user identified that seat functionality was missing from the toolbar despite being a core requirement. The seat placement system was integrated seamlessly with the existing furniture placement architecture.

### Technical Implementation
**Seat State Management:**
- Uses `Set<string>` to track seat positions with keys in format `"row-col"`
- Integrated with existing React state management in layout editor page
- Seat state passed to Grid component via props: `seats` and `onSeatsChange`

**Seat Placement Logic:**
- Seats cannot be placed on existing furniture (collision detection)
- Furniture placement removes existing seats from those positions
- Toggle behavior: click empty cell to add seat, click seat to remove
- Consistent with furniture placement interaction patterns

**Visual Design:**
- Seats display with ðŸ’º emoji for clear visual identification
- Green background (`#4CAF50`) with hover effects (`#45a049`)
- Distinct from furniture (brown desks, orange doors) and preview (blue) states

### File Integration
**Modified Components:**
- `components/layout/Grid.tsx` - Added seat rendering and interaction logic
- `components/layout/LayoutToolbar.tsx` - Seat tool already included
- `components/layout/types.ts` - ToolType includes 'seat' option
- `app/layout-editor/page.tsx` - Added seat state management
- `app/globals.css` - Added `.seat` CSS styling

**Enhanced Testing:**
- Added 2 new unit tests for seat rendering and interaction
- Added 3 new E2E tests for seat placement, collision, and removal scenarios
- All tests integrated with existing test suite (22 unit + 16 E2E tests)

### Quality Assurance
- All acceptance criteria met with comprehensive testing
- Zero regressions introduced to existing furniture functionality
- Maintains responsive design and accessibility standards
- TypeScript type safety preserved throughout implementation

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-06 | 1.0 | Retroactive story creation for seat functionality implemented in Story 1.2 | James (Dev) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 (claude-sonnet-4-20250514)

### Implementation Status
**Status: COMPLETED** - All functionality implemented and tested as part of Story 1.2

### Completion Notes List
- Seat placement system fully functional with toggle behavior
- Visual design consistent with overall application theme
- Comprehensive collision detection prevents seat-furniture conflicts
- State management integrated seamlessly with existing architecture
- Testing coverage includes both unit and end-to-end scenarios
- All acceptance criteria exceeded with intuitive user interactions

### File List
**Modified Files (as part of Story 1.2):**
- `components/layout/Grid.tsx` - Added seat rendering, state management, and interaction logic
- `app/layout-editor/page.tsx` - Added seat state (`seats: Set<string>`) and change handlers
- `app/globals.css` - Added CSS styling for `.seat` class with green background and hover effects

**Test Files Enhanced:**
- `__tests__/components/layout/Grid.test.tsx` - Added 2 unit tests for seat functionality
- `e2e/layout-editor.spec.ts` - Added 3 E2E tests for seat interaction scenarios

### Integration Notes
This story represents functionality that was seamlessly integrated with Story 1.2's furniture system. The seat placement follows the same interaction patterns as furniture but with simpler single-cell logic. The implementation maintains all architectural patterns and quality standards established in previous stories.

## QA Results
**Status: PASSED** - All functionality working as expected with comprehensive test coverage